from free_busy_times import *
from oit_slots import *
from times_comparer import *


def main():

    # Getting Busy and OIT Times from Athena Query
    print()
    athena_query = str({'u_2515006': {2515006: {'free_busy_data': [{'@odata.etag': 'W/"HZA23TVs+kWsn6wIr3TfGgABbUbVIQ=="', 'end': {'dateTime': '2024-05-30T17:30:00.0000000', 'timeZone': 'UTC'}, 'iCalUId': '040000008200E00074C5B7101A82E00800000000074CE13F1EB2DA01000000000000000010000000B7E1BBB34D8A5F48AC9F70AA45AD22EE', 'id': 'AAMkAGFjODI5MDBhLTAwM2YtNGYyOS1hOWUyLTlmY2VkMmE0ODA0YwBGAAAAAAC7GcrBetzSR6MPi9CG0XcpBwAdkDbdNWz6RayfrAivdN8aAAAAAAENAAAdkDbdNWz6RayfrAivdN8aAAFuBYOMAAA=', 'isAllDay': False, 'showAs': 'busy', 'start': {'dateTime': '2024-05-30T17:00:00.0000000', 'timeZone': 'UTC'}}, {'@odata.etag': 'W/"HZA23TVs+kWsn6wIr3TfGgABbUbVLA=="', 'end': {'dateTime': '2024-05-30T18:00:00.0000000', 'timeZone': 'UTC'}, 'iCalUId': '040000008200E00074C5B7101A82E00800000000A3BD8F451EB2DA01000000000000000010000000C5559A829EADC14EAB391156D27FDBF7', 'id': 'AAMkAGFjODI5MDBhLTAwM2YtNGYyOS1hOWUyLTlmY2VkMmE0ODA0YwBGAAAAAAC7GcrBetzSR6MPi9CG0XcpBwAdkDbdNWz6RayfrAivdN8aAAAAAAENAAAdkDbdNWz6RayfrAivdN8aAAFuBYONAAA=', 'isAllDay': False, 'showAs': 'busy', 'start': {'dateTime': '2024-05-30T17:30:00.0000000', 'timeZone': 'UTC'}}, {'@odata.etag': 'W/"HZA23TVs+kWsn6wIr3TfGgABbUZyHQ=="', 'end': {'dateTime': '2024-05-30T19:00:00.0000000', 'timeZone': 'UTC'}, 'iCalUId': '040000008200E00074C5B7101A82E00800000000FF0CED320BB1DA01000000000000000010000000125FC70FF3BF314A9B9E84488249DED5', 'id': 'AAMkAGFjODI5MDBhLTAwM2YtNGYyOS1hOWUyLTlmY2VkMmE0ODA0YwBGAAAAAAC7GcrBetzSR6MPi9CG0XcpBwAdkDbdNWz6RayfrAivdN8aAAAAAAENAAAdkDbdNWz6RayfrAivdN8aAAFuBYOHAAA=', 'isAllDay': False, 'showAs': 'busy', 'start': {'dateTime': '2024-05-30T18:00:00.0000000', 'timeZone': 'UTC'}}, {'@odata.etag': 'W/"HZA23TVs+kWsn6wIr3TfGgABahwncA=="', 'end': {'dateTime': '2024-05-30T19:30:00.0000000', 'timeZone': 'UTC'}, 'iCalUId': '040000008200E00074C5B7101A82E00800000000987296C33AADDA01000000000000000010000000D9FBF7C99B44C14DBE48DF51E2C6E5A9', 'id': 'AAMkAGFjODI5MDBhLTAwM2YtNGYyOS1hOWUyLTlmY2VkMmE0ODA0YwBGAAAAAAC7GcrBetzSR6MPi9CG0XcpBwAdkDbdNWz6RayfrAivdN8aAAAAAAENAAAdkDbdNWz6RayfrAivdN8aAAFq2iiGAAA=', 'isAllDay': False, 'showAs': 'busy', 'start': {'dateTime': '2024-05-30T19:00:00.0000000', 'timeZone': 'UTC'}}, {'@odata.etag': 'W/"HZA23TVs+kWsn6wIr3TfGgABbUZyOg=="', 'end': {'dateTime': '2024-05-30T20:30:00.0000000', 'timeZone': 'UTC'}, 'iCalUId': '040000008200E00074C5B7101A82E008000000007922013A0BB1DA010000000000000000100000002601D7AF5A12C6428F73960FA35F76D3', 'id': 'AAMkAGFjODI5MDBhLTAwM2YtNGYyOS1hOWUyLTlmY2VkMmE0ODA0YwBGAAAAAAC7GcrBetzSR6MPi9CG0XcpBwAdkDbdNWz6RayfrAivdN8aAAAAAAENAAAdkDbdNWz6RayfrAivdN8aAAFuBYOIAAA=', 'isAllDay': False, 'showAs': 'busy', 'start': {'dateTime': '2024-05-30T19:30:00.0000000', 'timeZone': 'UTC'}}, {'@odata.etag': 'W/"HZA23TVs+kWsn6wIr3TfGgABbUa29w=="', 'end': {'dateTime': '2024-06-10T00:00:00.0000000', 'timeZone': 'UTC'}, 'iCalUId': '040000008200E00074C5B7101A82E008000000006686D61AC1ABDA01000000000000000010000000880F2892D4BF0B4BBC39741DBD756732', 'id': 'AAMkAGFjODI5MDBhLTAwM2YtNGYyOS1hOWUyLTlmY2VkMmE0ODA0YwBGAAAAAAC7GcrBetzSR6MPi9CG0XcpBwAdkDbdNWz6RayfrAivdN8aAAAAAAENAAAdkDbdNWz6RayfrAivdN8aAAFoDU85AAA=', 'isAllDay': True, 'showAs': 'busy', 'start': {'dateTime': '2024-05-31T00:00:00.0000000', 'timeZone': 'UTC'}}, {'@odata.etag': 'W/"HZA23TVs+kWsn6wIr3TfGgABZ0/Rsg=="', 'end': {'dateTime': '2024-06-05T00:00:00.0000000', 'timeZone': 'UTC'}, 'iCalUId': '040000008200E00074C5B7101A82E00800000000C1D79EBFDCAADA01000000000000000010000000423271AF43B9F24D9E6F9B4438A620F3', 'id': 'AAMkAGFjODI5MDBhLTAwM2YtNGYyOS1hOWUyLTlmY2VkMmE0ODA0YwBGAAAAAAC7GcrBetzSR6MPi9CG0XcpBwAdkDbdNWz6RayfrAivdN8aAAAAAAENAAAdkDbdNWz6RayfrAivdN8aAAFoDU84AAA=', 'isAllDay': False, 'showAs': 'busy', 'start': {'dateTime': '2024-06-04T20:00:00.0000000', 'timeZone': 'UTC'}}], 'internal_busy_times': [], 'native_cal_data': {'busy_times': [], 'oits': [{'end': '2024-05-30T19:00:00Z', 'group_ids': '', 'group_ids_list': [], 'job_requisition_ids': {'ats_job_ids': [], 'client_job_ids': []}, 'jobloc_ids': '', 'jobloc_ids_list': [], 'oit_number': 1, 'oit_types': '1,2,3,4,7,8,9', 'oit_types_list': [1, 2, 3, 4, 7, 8, 9], 'priority': False, 'start': '2024-05-30T17:28:00Z', 'user_id': 2515006}, {'end': '2024-05-31T19:00:00Z', 'group_ids': '', 'group_ids_list': [], 'job_requisition_ids': {'ats_job_ids': [], 'client_job_ids': []}, 'jobloc_ids': '', 'jobloc_ids_list': [], 'oit_number': 1, 'oit_types': '1,2,3,4,7,8,9', 'oit_types_list': [1, 2, 3, 4, 7, 8, 9], 'priority': False, 'start': '2024-05-31T14:00:00Z', 'user_id': 2515006}, {'end': '2024-06-01T18:00:00Z', 'group_ids': '', 'group_ids_list': [], 'job_requisition_ids': {'ats_job_ids': [], 'client_job_ids': []}, 'jobloc_ids': '', 'jobloc_ids_list': [], 'oit_number': 1, 'oit_types': '1,2,3,4,7,8,9', 'oit_types_list': [1, 2, 3, 4, 7, 8, 9], 'priority': False, 'start': '2024-06-01T13:00:00Z', 'user_id': 2515006}, {'end': '2024-06-02T20:00:00Z', 'group_ids': '', 'group_ids_list': [], 'job_requisition_ids': {'ats_job_ids': [], 'client_job_ids': []}, 'jobloc_ids': '', 'jobloc_ids_list': [], 'oit_number': 1, 'oit_types': '1,2,3,4,7,8', 'oit_types_list': [1, 2, 3, 4, 7, 8], 'priority': False, 'start': '2024-06-02T15:15:00Z', 'user_id': 2515006}, {'end': '2024-06-03T22:00:00Z', 'group_ids': '', 'group_ids_list': [], 'job_requisition_ids': {'ats_job_ids': [], 'client_job_ids': []}, 'jobloc_ids': '', 'jobloc_ids_list': [], 'oit_number': 1, 'oit_types': '1,2,3,4,7,8', 'oit_types_list': [1, 2, 3, 4, 7, 8], 'priority': False, 'start': '2024-06-03T17:00:00Z', 'user_id': 2515006}, {'end': '2024-06-04T22:00:00Z', 'group_ids': 'PDX_SS_DC91F070-FEBC-43AA-BC97-F8EE1FA1FB55,PDX_SS_BC1DE51B-3377-44D1-80A0-797E05C27DB7,PDX_SS_027EE167-888C-45BE-AD31-BAC90BBA4750', 'group_ids_list': ['PDX_SS_DC91F070-FEBC-43AA-BC97-F8EE1FA1FB55', 'PDX_SS_BC1DE51B-3377-44D1-80A0-797E05C27DB7', 'PDX_SS_027EE167-888C-45BE-AD31-BAC90BBA4750'], 'job_requisition_ids': {'ats_job_ids': [], 'client_job_ids': []}, 'jobloc_ids': '', 'jobloc_ids_list': [], 'oit_number': 1, 'oit_types': '1,2,3,4,7,8,9', 'oit_types_list': [1, 2, 3, 4, 7, 8, 9], 'priority': False, 'start': '2024-06-04T17:00:00Z', 'user_id': 2515006}, {'end': '2024-06-05T22:00:00Z', 'group_ids': '', 'group_ids_list': [], 'job_requisition_ids': {'ats_job_ids': [], 'client_job_ids': []}, 'jobloc_ids': '', 'jobloc_ids_list': [], 'oit_number': 1, 'oit_types': '1,2,3,4,7,8,9', 'oit_types_list': [1, 2, 3, 4, 7, 8, 9], 'priority': False, 'start': '2024-06-05T17:00:00Z', 'user_id': 2515006}, {'end': '2024-06-06T15:28:00Z', 'group_ids': '', 'group_ids_list': [], 'job_requisition_ids': {'ats_job_ids': [], 'client_job_ids': []}, 'jobloc_ids': '', 'jobloc_ids_list': [], 'oit_number': 1, 'oit_types': '1,2,3,4,7,8,9', 'oit_types_list': [1, 2, 3, 4, 7, 8, 9], 'priority': False, 'start': '2024-06-06T14:00:00Z', 'user_id': 2515006}]}, 'scheduled_times': [{'end': '2024-05-30T17:30:00Z', 'lead_id': 128549579, 'start': '2024-05-30T17:00:00Z'}, {'end': '2024-05-30T16:30:00Z', 'lead_id': 120998943, 'start': '2024-05-30T16:00:00Z'}]}}})
    busy_slots = get_busy_list(athena_query)
    print()
    oit_slots = get_oit_list(athena_query)

    split_days(oit_slots, busy_slots)

main()
